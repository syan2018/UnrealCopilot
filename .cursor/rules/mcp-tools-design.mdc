---
description: "MCP 工具设计原则和完整工具清单"
---

# MCP 工具设计指南

## 设计原则

**最小困惑度，最大能力覆盖。**

1. 用最少的工具达成最完整的能力
2. 统一接口优于分散工具
3. 返回结构化数据，包含足够上下文
4. 错误信息友好，帮助用户定位问题

## 工具清单（v0.3.0，共 9 个）

### 核心工具（4 个）

| 工具 | 用途 | 参数 |
|------|------|------|
| `search` | 统一搜索 C++/Blueprint/Asset | domain, scope, query |
| `get_hierarchy` | 获取继承层次 | name, domain, scope |
| `get_references` | 获取引用关系 | path, domain, direction |
| `get_details` | 获取详细信息 | path, domain, scope |

### 特殊工具（5 个）

| 工具 | 用途 | 为什么需要 |
|------|------|------------|
| `get_blueprint_graph` | 获取蓝图节点图 | 需要图结构返回 |
| `detect_ue_patterns` | 检测 UE 模式 | UPROPERTY/UFUNCTION 分析 |
| `get_cpp_blueprint_exposure` | 获取 C++ 暴露 API | 专门的 C++→BP 接口分析 |
| `trace_reference_chain` | 跨域引用链追踪 | 递归深度遍历 |
| `find_cpp_class_usage` | C++ 类使用查找 | BP 中的 C++ 类使用 |

## 三层搜索模型

```
scope 参数：
├── "project"  → 只搜索项目源码（默认，快）
├── "engine"   → 只搜索引擎源码
└── "all"      → 搜索所有（慢但全面）
```

## 典型调用流程

### 场景：分析 GAS Ability

```python
# 1. 搜索蓝图
await search(query="GA_Hero_Dash", domain="blueprint")

# 2. 获取继承层次
await get_hierarchy(name="/Game/.../GA_Hero_Dash", domain="blueprint")

# 3. 获取依赖
await get_references(path="/Game/.../GA_Hero_Dash", domain="blueprint", direction="outgoing")

# 4. 分析 C++ 父类
await get_details(path="UGameplayAbility", domain="cpp", scope="engine")

# 5. 获取节点图（需要专门工具）
await get_blueprint_graph(bp_path="/Game/.../GA_Hero_Dash", graph_name="EventGraph")
```

### 场景：追踪资产引用

```python
# 1. 搜索资产
await search(query="SK_Mannequin", domain="asset")

# 2. 获取引用者
await get_references(path="/Game/.../SK_Mannequin", domain="asset", direction="incoming")

# 3. 深度追踪
await trace_reference_chain(start_asset="/Game/.../SK_Mannequin", max_depth=2)
```

### 场景：分析 C++ 类暴露

```python
# 1. 检测 UE 模式
await detect_ue_patterns(file_path="Source/MyGame/MyActor.h")

# 2. 获取 Blueprint 暴露汇总
await get_cpp_blueprint_exposure(file_path="Source/MyGame/MyActor.h")
```

## HTTP API（UE 插件）

```
GET /health                           → 健康检查
GET /blueprint/graph?bp_path=...      → 蓝图节点图
GET /analysis/reference-chain?...     → 引用链追踪
GET /analysis/cpp-class-usage?...     → C++ 类使用
GET /analysis/job/status?id=...       → 异步任务状态
GET /analysis/job/result?id=...       → 异步任务结果
```

## 与 v0.2.0 对比

| 版本 | 工具数 | 变化 |
|------|--------|------|
| v0.2.0 | 22 | 原始工具 + unified |
| v0.3.0 | 9 | 仅保留 unified + 必要特殊工具 |

删除的工具（被 unified 替代）：
- `search_blueprints` → `search(domain="blueprint")`
- `search_assets` → `search(domain="asset")`
- `search_cpp_code` → `search(domain="cpp")`
- `get_blueprint_hierarchy` → `get_hierarchy(domain="blueprint")`
- `get_cpp_class_hierarchy` → `get_hierarchy(domain="cpp")`
- `get_blueprint_dependencies` → `get_references(direction="outgoing")`
- `get_blueprint_referencers` → `get_references(direction="incoming")`
- `get_asset_references` → `get_references(direction="outgoing")`
- `get_asset_referencers` → `get_references(direction="incoming")`
- `find_cpp_references` → `get_references(domain="cpp")`
- `get_blueprint_details` → `get_details(domain="blueprint")`
- `get_asset_metadata` → `get_details(domain="asset")`
- `analyze_cpp_class` → `get_details(domain="cpp")`
